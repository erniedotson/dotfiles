if [ -f "$HOME/.bashrc_extra" ]; then
	. "$HOME/.bashrc_extra"
fi

if ! [[ "$PATH" =~ "$HOME/.local/bin:$HOME/bin:" ]]; then
    PATH="$HOME/.local/bin:$HOME/bin:$PATH"
fi
export PATH

if [ -f "$HOME/.bash_aliases" ]; then
	. "$HOME/.bash_aliases"
fi

# MARK: Load apps

# direnv
if command -v direnv >/dev/null 2>&1; then
	eval "$(direnv hook bash)"
fi

# nvm
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

# pyenv
export PYENV_ROOT="$HOME/.pyenv"
[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"
if command -v pyenv >/dev/null 2>&1; then
	eval "$(pyenv init - bash)"       # adds the shims to the PATH
	eval "$(pyenv virtualenv-init -)" # enables shims and autocompletion
fi

# shellenv
if command -v shellenv >/dev/null 2>&1; then
	eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

# starship
if command -v starship >/dev/null 2>&1; then
	eval "$(starship init bash)"
fi

# thefuck
if command -v thefuck >/dev/null 2>&1; then
	eval $(thefuck --alias)
fi

# MARK: ssh GitBash Windows
if [[ "$OSTYPE" == "msys" || "$OSTYPE" == "cygwin" ]]; then
	###############################################################################
	# Start SSH Agent for Git Bash on Windows
	# See: https://gist.github.com/jherax/979d052ad5759845028e6742d4e2343b
	###############################################################################
	SSH_ENV="$HOME/.ssh/environment"

	function run_ssh_env {
	. "${SSH_ENV}" > /dev/null
	}

	function start_ssh_agent {
	echo "Initializing new SSH agent..."
	ssh-agent | sed 's/^echo/#echo/' > "${SSH_ENV}"
	echo "succeeded"
	chmod 600 "${SSH_ENV}"

	run_ssh_env;

	#   ssh-add ~/.ssh/id_rsa;
	#   ssh-add ~/.ssh/id_ed25519;
	ssh-add;
	}

	if [ -f "${SSH_ENV}" ]; then
	run_ssh_env;
	ps -ef | grep ${SSH_AGENT_PID} | grep ssh-agent$ > /dev/null || {
		start_ssh_agent;
	}
	else
	start_ssh_agent;
	fi

	###############################################################################
	###############################################################################
fi
